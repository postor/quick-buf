!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.QuickBuf=t():e.QuickBuf=t()}(self,(function(){return(()=>{"use strict";var e={605:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StructureMeta=t.Structure=void 0;var n=r(128),a=function(){function e(e,t,r){this.type=e,this.name=t,this.contents=r}return e.detect=function(t,r){if(void 0===r&&(r=""),Array.isArray(t))return new e("array",r,e.detect(t[0]));var n=typeof t;if("object"==n){var a=[];for(var u in t){var i=e.detect(t[u],u);i&&a.push(i)}if(!a.length)return;return new e(n,r,a)}return"function"!=n&&"symbol"!=n?new e(n,r):void 0},e.parse=function(t,r){if(void 0===r&&(r=""),Array.isArray(t))return new e("array",r,e.parse(t[0]));var n=typeof t;if("object"==n){var a=t,u=[];for(var i in a){var o=e.parse(a[i],i);o&&u.push(o)}return new e(n,r,u)}return new e(t,r)},e.unparse=function(t){switch(t.type){case"array":return[e.unparse(t.contents)];case"object":for(var r={},n=0,a=t.contents;n<a.length;n++){var u=a[n];r[u.name]=e.unparse(u)}return r;default:return t.type}},e.restruct=function(t){for(var r=t.map((function(t){var r=t.name,a=t.type;return new e(n.ValueTypes[a],r,a==n.TypeValues.object?[]:void 0)})),a=0;a<t.length;a++){var u=t[a].parent;if(u!=a){var i=r[u];"object"==i.type?i.contents.push(r[a]):i.contents=r[a]}}return r[0]},e}();t.Structure=a,t.StructureMeta=a.parse([{name:"string",type:"uint",parent:"uint"}])},74:function(e,t){var r=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,a=e.length;r<n;r++,a++)e[a]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.VUintReader=t.writeUint=void 0,t.writeUint=function(e,t){for(var n=e,a=[];n;)a.unshift(127&n|128),n>>=7;a.length||a.push(0),a[a.length-1]&=127,t.splice.apply(t,r([t.length,0],a))};var n=function(){function e(e){this.bytes=e,this.offset=0}return e.prototype.read=function(){for(var e=0;e<<=7,e|=127&this.bytes[this.offset],this.offset++,128&this.bytes[this.offset-1];);return e},e}();t.VUintReader=n},478:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BitReader=t.bits2bytes=void 0,t.bits2bytes=function(e){for(var t=Math.ceil(e.length/8),r=new Uint8Array(t),n=0;n<t;n++)for(var a=0;a<8;a++){var u=8*n+a;if(u==e.length)break;r[n]|=e[u]?1<<a:0}return r};var r=function(){function e(e){this.bytes=e,this.index=0}return e.prototype.read=function(){var e=this.index%8,t=(this.index-e)/8;return this.index++,this.bytes[t]&1<<e},e}();t.BitReader=r},128:(e,t)=>{for(var r in Object.defineProperty(t,"__esModule",{value:!0}),t.concatBuf=t.toBuf=t.TypeSizes=t.TypeClasses=t.ValueTypes=t.TypeValues=void 0,t.TypeValues={UInt32:0,Int32:1,UInt16:2,Int16:3,Int8:4,UInt8:5,BigUint64:6,BigInt64:7,Float32:8,Float64:9,boolean:10,string:11,uint:12,array:13,object:14,number:15,Double:16,Float:17,bigint:18,undefined:19,float:20},t.ValueTypes=[],t.TypeValues)t.ValueTypes[t.TypeValues[r]]=r;t.TypeClasses=[Uint32Array,Int32Array,Uint16Array,Int16Array,Int8Array,Uint8Array,BigUint64Array,BigInt64Array,Float32Array,Float64Array],t.TypeSizes=[4,4,2,2,1,1,8,8,4,8],t.toBuf=function(e,r){if("boolean"==e)return function(e){for(var t=Math.ceil(e.length/8),r=new Uint8Array(t),n=0;n<t;n++)for(var a=0;a<8;a++){var u=8*n+a;if(u==e.length)break;r[n]|=e[u]?1<<a:0}return r.buffer}(r);if(t.TypeValues[e]>10)throw"not supported type: "+e;return r.buffer},t.concatBuf=function(e){for(var t=e.reduce((function(e,t){return e+t.byteLength}),0),r=new Uint8Array(t),n=0,a=0,u=e;a<u.length;a++){var i=u[a],o=new Uint8Array(i);r.set(o,n),n+=o.length}return r.buffer}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var u=t[n]={exports:{}};return e[n].call(u.exports,u,u.exports,r),u.exports}var n={};return(()=>{var e=n;Object.defineProperty(e,"__esModule",{value:!0}),e.decode=void 0;var t=r(478),a=r(605),u=r(128),i=r(74),o=new TextDecoder;function s(e,t,r,n){var a=0,u=new t(e,r,n);return function(){return u[a++]}}e.decode=function(e,r){for(var n=0,f=function(){var t=s(e,Uint32Array,n,1)();return n+=4,t},c=f(),y=new Array(10).fill(0),p=0;p<y.length;p++)c&1<<p&&(y[p]=f());var l,v,d,h=2048&c&&f(),b=4096&c&&f(),g=y.map((function(t,r){if(!t)return function(){return 0};var a=u.TypeSizes[r]*t,i=s(e.slice(n,n+a),u.TypeClasses[r]);return n+=a,i}));g[u.TypeValues.boolean]=(l=Math.ceil(h/8),v=new t.BitReader(new Uint8Array(e,n,l)),n+=l,function(){return v.read()}),g[u.TypeValues.string]=(d=n,n+=b,function(){var t=g[u.TypeValues.uint]();if(!t)return"";if(e.byteLength<t+d)throw"out of range";var r=o.decode(new Uint8Array(e,d,t));return d+=t,r}),g[u.TypeValues.uint]=function(){var t=new i.VUintReader(new Uint8Array(e,n));return function(){return t.read()}}();var T,w=r?r instanceof a.Structure?r:a.Structure.parse(r):(T=A(a.StructureMeta),a.Structure.restruct(T));return A(w);function A(e){switch(e.type){case"array":return function(e){for(var t=[],r=g[u.TypeValues.uint](),n=0;n<r;n++)t.push(A(e));return t}(e.contents);case"object":return function(e){for(var t={},r=0,n=e;r<n.length;r++){var a=n[r];t[a.name]=A(a)}return t}(e.contents);case"bigint":case"string":return g[u.TypeValues.string]();case"number":case"Double":return g[u.TypeValues.Float64]();case"Float":case"float":return g[u.TypeValues.Float32]();default:return g[u.TypeValues[e.type]]()}}}})(),n})()}));